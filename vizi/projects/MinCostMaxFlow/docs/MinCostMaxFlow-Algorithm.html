<html>
    <title>Максимальный поток минимальной стоимости</title>
    <meta http-equiv=Content-Type content="text/html; charset=utf-8">
    <body>
        <h4>Описание алгоритма:</h4>
        <p>
        Задача:<br>
        Дана транспортная сеть. Требуется найти в ней такой максимальный поток, стоимость которого минимальна.
        </p>
        <p>
        Алгоритм:
        </p>
        <ol>
            <li>
            Для каждого ребра, соединяющего вершины <img src=./images/u.gif alt="u">
            и <img src=./images/v.gif alt="v"> добавим обратное, соединяющее вершины <img src=./images/v.gif alt="v">
            и <img src=./images/u.gif alt="u">, с пропускной способностью равной нулю и стоимостью, равной минус стоимости прямого ребра.
            </li>

            <li>
            Введем для каждой вершины <img src=./images/u.gif alt="u"> потенциал <img src=./images/phi_u.gif align=middle alt="\varphi_u"> 
            и расстояние от источника <img src=./images/d_u.gif alt="d_u" align=absmiddle>. Пусть сначала они будут равны нулю.
            </li>

            <li>
            Для каждого ребра <img src=./images/e.gif" alt="e"> (в том числе и для обратного), соединяющего вершины 
            <img src=./images/u.gif alt="u"> и <img src=./images/v.gif alt="v">, введем вес 
            <img src=./images/weight(e).gif alt="\mathrm{weight}(e)=\mathrm{cost}(e)+\varphi_u-\varphi_v" align=absmiddle> (именно
            для определения весы и нужны потенциалы &mdash; без них вес мог бы быть отрицательным для обрытных ребер и нельзя было бы применить алгоритм Дейкстры),
            где <img src=./images/cost(e).gif alt="\mathrm{cost}(e)" align=absmiddle> &mdash; вес ребра.
            </li>

            <li>
            С помощью алгоритма <a href=http://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%94%D0%B5%D0%B9%D0%BA%D1%81%D1%82%D1%80%D1%8B>Дейкстры</a> находим расстояния от источника до всех вершин (в поиске участвуют только те ребра, поток по которым не максимальный). Если нет пути от источника до стока,
            значит максимальный поток найден и можно завершить алгоритм. Если нет &mdash; идем дальше.
            </li>

            <li>
            Выставляем потенциалы для каждой вершины равными расстояниям от источника, которые нашли на предыдущем шаге.
            </li>

            <li>
            Восстанавливаем кратчайший путь.
            </li>

            <li>
            Находим максимальный дополняющий поток на этом пути.
            </li>

            <li>
            Пропускаем найденный поток через кратчайший путь. Когда поток пропускается через ребро, то через соответствующее 
            обратное (или прямое) ребро пропускается поток равный по модулю, но противоположный по значению. 
            Таким образом, обратное ребро характеризует на сколько можно уменьшить поток через прямое ребро, и какая с этого будет выгода.
            </li>

            <li>
            Итерация алгоритма закончена, идем на шаг 3.
            </li>

        </ol>
    </body>
</html> 
